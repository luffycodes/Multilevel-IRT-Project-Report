\documentclass[12pt]{article}
\usepackage{lineno, blindtext,  enumerate, algorithmic }
\usepackage{amssymb}
\usepackage{hyperref}
\usepackage{amsthm}
\usepackage{amsmath}
\usepackage{natbib}
\usepackage{graphicx}
% \usepackage[sorting=none]{biblatex}
\usepackage{enumitem}
\renewcommand{\baselinestretch}{1.0}
% \setlength{\oddsidemargin}{0.0in}
% \setlength{\evensidemargin}{0.0in}
% \setlength{\topmargin}{0.0in}
% \setlength{\textheight}{8.5in}
% \setlength{\textwidth}{6.5in}
\usepackage[letterpaper]{geometry}
\geometry{top=1.0in, bottom=1.0in, left=1.0in, right=1.0in}
\setlength{\headsep}{0in}
\setlength{\parindent}{0in}
\usepackage{setspace}
\doublespacing
\newcommand{\utwi}[1]{\mbox{\boldmath $ #1$}}
\pagestyle{plain}
\includeonly{}

\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

% \bibliography{references}

\begin{document}

\begin{center}
{\bf RICE UNIVERSITY} \\
STAT 525 \\
{\it Bayesian Statistics} \\ 
\vspace{5pt}
Shashank Sonkar \\
\vspace{11pt}
{\bf Project Report}
\end{center}

\section{Item Response Theory}
Let us say we are given some questions, and students' responses to these questions (responses are either marked correct or incorrect). Given this information, one of the most important tasks in the field of educational data mining is to predict each question's (also called an item) difficulty and each student's proficiency. Rasch laid the foundation of item response theory (IRT) in around 1960s \cite{rasch1960probabilistic,rasch1966item}. Using Markov Chain Monte Carlo (MCMC) methods, one can estimate the item difficulty and student proficiency parameters.

In this project, I plan to first do a short review of IRT to understand its foundations (e.g., model design like 1PL, 2PL, 3PL models) and sampling methods that are often used to estimate its parameters.

Then, I plan to deep dive into the following paper - Bayesian estimation of a multilevel IRT model using Gibbs sampling \cite{fox2001bayesian}. This paper extends the standard IRT model further by grouping students into schools, and proposing a multilevel regression model to study the properties of second-level groups (e.g. schools, in this case) as well. It adopts a fully Bayesian approach, unlike its predecessors, that provides it benefits like uncertainty quantification, and ease of incorporating information about schools through priors.

Lastly, I plan to implement the model in Stan (implementation of multilevel IRT model is available in MLIRT package in R) and also, test the model performance on a bigger PISA 2003 dataset (authors tested on an older PISA dataset, number of students and schools in PISA 2003 are 3829 and 150 respectively, versus 2156 and 97 in the older dataset).

\section{Main topics to be covered:}
\begin{enumerate}[label=(\alph*)]
    \item Understand standard IRT models
    \item Understand the assumption of homoscedasticity in standard IRT models that the paper tries to alleviate.
    \item Understand two-Level one-way random effects ANOVA model.
    \item Study how the above model can be used to model the multilevel extension to the standard IRT model.
    \item Understand the estimation of multilevel IRT model parameters using Gibbs sampling.
    \item Implement the model in Stan.
    \item Run the R and Stan models on PISA 2003 dataset to compare the two implementations, and also test the model's performance on a bigger dataset (since, authors analyzed an older, smaller PISA dataset in the paper).
\end{enumerate}

\section{Points to mention}
\begin{itemize}
    \item IRT models do not explain - multilevel IRT models are an attempt to integrate at least some interpretability.
    
    pg 5- (See Appendix E, “Linear Logistic Test Model [LLTM],” for a brief presentation of one of these explanatory approaches, as well as De Boeck \& Wilson [2004] for alternative approaches.) The cognitive processes used by an individual to respond to an item are not modeled in the commonly used IRT models. In short, this approach is analogous to measuring the speed of an automobile without understanding how an automobile moves. \cite{de2013theory}
    
    \item  Use these values as priors.
    
    pg 15 - However, typical item and person locations fall within –3 to 3 \cite{de2013theory}.
    
    pg 101 - Reasonably good values of $\alpha$ range from approximately 0.8 to about 2.5 \cite{de2013theory}.
\end{itemize}

\section{Conceptual Development of x-PL IRT Models}

\subsection{1-PL IRT Model}
In an IRT model, one estimates the properties of the item which are responsible for the differing responses to that item. In education, these items are generally questions. In the 1-PL model, the most characteristic of the item is measured, which is the difficulty of the item. The probability that a learner will answer $j^{th}$ item correctly is modeled by:

\begin{equation}\label{eq:1pl}
    P(y_j=1|\theta, \delta_j) = \frac{e^{\theta - \delta_j}}{1+e^{\theta - \delta_j}},
\end{equation}
where $y_j$ models the correctness of the response of the student to item $j$ (1 if correct, 0 otherwise),  $\theta$ is the learner's ability parameter, and $\delta_j$ is the item' difficulty parameter.

\subsection{2-PL IRT Model}
One can observe from \eqref{eq:1pl} that when a student's ability parameter, $\theta$, is equal to $\delta_j$, the probability of the student answering the question $j$ correctly is $0.5$. As $\theta$ moves away from $\delta_j$, the change in success probability ($dP/ d\theta) $ is not a function of the item (sigmoid function only gets shifted by $\delta_j$). However, in educational settings, some items may require a large change in $\theta$ to achieve some fixed change in success probability from $0.5$. To elucidate, $\delta_j$ is fixed at 1 in figure \ref{fig:2pl}. The blue line indicates the change in success probability across item 1 and item 2, when the ability parameter of the learner changes from 1 to 2. Thus, item 1 is said to be better at `discriminating' learners (more sensitive to $\theta$), since a large change in $\theta$ is needed for the same increase in success probability from 0.5.

\begin{figure}[t]
    \includegraphics[scale=0.5]{Plots/2pl.png}
    \centering
    \caption{2PL model}
    \label{fig:2pl}
\end{figure}

The probability that a learner will answer $j^{th}$ item correctly in the 2PL model is modeled by:

\begin{equation}\label{eq:2pl}
    P(y_j=1|\theta, \delta_j, \alpha_j) = \frac{e^{\alpha_j(\theta - \delta_j)}}{1+e^{\alpha_j(\theta - \delta_j)}},
\end{equation}
where $\alpha_j$ is the item's discrimination parameter.

\subsection{3-PL IRT Model}
In educational settings, multiple-choice questions (MCQs) are the easiest to grade, since open-form questions require human intervention to grade the response. However, designing the choices for MCQs is challenging. A question may be hard, but looking at the choices, it may be easy to guess the correct response. `By chance alone', it may be possible to correctly answer the item. To model this probability of correctly answering the item, purely by chance, 3-PL model is used.

The probability that a learner will answer $j^{th}$ item correctly in the 3-PL model is modeled by:

\begin{equation}\label{eq:3pl}
    P(y_j=1|\theta, \delta_j, \alpha_j) = \chi_j + (1 - \chi_j) \frac{e^{\alpha_j(\theta - \delta_j)}}{1+e^{\alpha_j(\theta - \delta_j)}},
\end{equation}
where $\chi_j$ models the probability of correctly answering the item by pure guessing.


\section{Multilevel IRT Model Specifications}
\subsection{Motivation for multilevel IRT model}
\begin{itemize}
    \item The assumption of homoscedasticity in standard IRT models.
    \item Write about the change from sigmoid to normal ogive function.
    \item IRT models do not explain - multilevel IRT models are an attempt to integrate at least some interpretability.
    
    pg 5- (See Appendix E, “Linear Logistic Test Model [LLTM],” for a brief presentation of one of these explanatory approaches, as well as De Boeck \& Wilson [2004] for alternative approaches.) The cognitive processes used by an individual to respond to an item are not modeled in the commonly used IRT models. In short, this approach is analogous to measuring the speed of an automobile without understanding how an automobile moves. \cite{de2013theory}
\end{itemize}

\subsection{Description of `levels' in multilevel IRT model}

Let learners be indexed by variable $i$, which ranges $1$ to $n_j$, where $j$ represents the index of the school from $1$ to $J$. Let items be indexed by variable $k$, which ranges from $1$ to $K$. Then, the probability that the learner $i$ studying in school $j$ will answer the item $k$ correctly is modeled by:

\begin{equation}\label{first_level}
    P(Y_{ijk}=1) | \theta_i, a_k, b_k) = \Phi(a_k \theta_{ij} - b_k),
\end{equation}

where $\theta_{ij}$ is the ability parameter of student $i$ in school $j$, $a_k$ is the item's discriminative power parameter, and $b_k$ is the item's difficulty parameter. Equation \eqref{first_level} models the first level of the multi-level IRT model.

At level 2, let there be $Q$ covariates, denoted by $\boldsymbol{x}$, to model $\theta_{ij}$. Then,

\begin{equation}\label{second_level}
    \theta_{ij} = \beta_{0j} + \beta_{1j}x_{1ij} + ... + \beta_{Qj}x_{Qij} + e_{ij}.
\end{equation}

$x_{qij}$, where $q \in [1, Q]$, contains the properties of the learner indexed by $ij$. It can be 0 or 1, denoting if the learner is male or female. It can be an integer to model the age of the learner. Once the parameters $\beta_{qj}$ are learned, one can explain the influence of learners' properties on their abilities and how they vary across schools. For instance, one can analyze the impact of learner's age (modeled by $\beta$) on his or her ability (modeled by $\theta$), depending on the school (modeled by the index $j$ in $\beta$).

Note that this level captures variance in student abilities within the same school.

At level 3, let there be $S$ covariates, denoted by $\boldsymbol{w}$.

\begin{equation}
    \beta_{qj} = \gamma_{0q} + \gamma_{1q}w_{1j} + ... + \gamma_{Sq}w_{Sj} + u_{qj},
\end{equation}

for all $q \in [1, Q]$, and for all $ j \in [1, J]$. $w_{sj}$, where $s \in [1, S]$, contains the $s^{th}$ property of school $j$. For instance, it can be an integer to model the social, economic, and cultural status of the school. Then, $\gamma_{sq}$ will explain the influence of the status of the school in relation to the $q^{th}$ property of the learner. For instance, if the $q^{th}$ property denotes if the learner is female or not ($x_{qij}$ is 1 if the $i^{th}$ learner in $j^{th}$ school is female, otherwise 0), one can analyze the importance of status of the school for better learning of the female students.

Note that this level captures variance in student abilities across different schools. Thus, it can explain the contribution of the school on difference in abilities of students.

Also, $e_{ij} \sim \mathcal{N}(0, \sigma^2)$, while $\boldsymbol{u_j} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{T})$.

\textbf{Distinction from the paper notation and possible error:}
Notation from the paper \cite{fox2007multilevel} is followed, however, the paper reviewed is \cite{fox2001bayesian} from the same author. \cite{fox2001bayesian} was published in 2001, while \cite{fox2007multilevel} was published in 2007. This was done because \cite{fox2001bayesian} made an error (as far as I understood), and treated $w$ to be indexed by $q$ as well. Equation 5 from \cite{fox2001bayesian} is written below.

\begin{equation*}
    \beta_{qj} = \gamma_{0q} + \gamma_{1q}w_{11j} + ... + \gamma_{Sq}w_{Sqj} + u_{qj}, \text{ for } q\in [0,.., Q].
\end{equation*}

\subsection{Identifiability Issues}

\subsection{Common Priors}

\section{MCMC algorithm for estimating Multilevel IRT}
Full conditionals for multilevel IRT model parameters are given by:
\begin{enumerate}
    \item $\mathcal{E}$
\end{enumerate}

\section{Experiments}
\subsection{Dataset}

\subsection{Results}




\bibliographystyle{plain}
\bibliography{references}
% \printbibliography

% New page for appendix
% \newpage
% \section*{Appendix}
% \emph{Plots and longer (but still edited!) \texttt{R} scripts may be included here.}

\end{document}


